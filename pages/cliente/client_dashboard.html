<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mis Pedidos | Pastelería Lama</title>

    <link rel="icon" type="image/png" href="../../assests/faviconLama.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../../style.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@300;400;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <link rel="stylesheet" href="./css/client_dashboard.css">
</head>

<body data-required-role="cliente">

    <nav class="navbar navbar-expand-lg sticky-top">
        <div class="container">
            <img src="/assests/Logo Lama.png" alt="Pastelería Lama" class="nav-logo me-3">
            <a class="logo" href="/index.html">Pastelería <span>Lama</span></a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="/index.html">Inicio</a></li>
                    <li class="nav-item"><a class="nav-link" href="/pages/products.html">Productos</a></li>
                    <li class="nav-item"><a class="nav-link" href="/pages/orders.html">Encargos</a></li>
                    <li class="nav-item"><a class="nav-link" href="/pages/contact.html">Contacto</a></li>
                    <li class="nav-item"><a class="nav-link" href="/pages/login.html" id="navAuthLink">Login</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="py-5">
        <div class="container">

            <div class="d-flex flex-wrap justify-content-between align-items-center gap-3 mb-4">
                <div>
                    <h1 class="h3 fw-bold mb-1" style="font-family:'Playfair Display',serif;">Panel de pedidos</h1>
                    <div class="text-muted">Añade productos, elige fecha de recogida y genera el “PDF”</div>
                </div>

                <div class="d-flex gap-2 flex-wrap">
                    <a class="btn btn-outline-secondary fw-bold" href="/pages/panel-cliente.html">
                        <i class="fa-solid fa-arrow-left me-2"></i>Volver al perfil
                    </a>
                    <button id="logoutBtn" class="btn btn-danger fw-bold">
                        <i class="fa-solid fa-right-from-bracket me-2"></i>Cerrar sesión
                    </button>
                </div>
            </div>

            <div class="row g-4">
                <!-- catalogo -->
                <div class="col-lg-8">
                    <div class="cd-card">
                        <div class="cd-card-head">
                            <div>
                                <div class="cd-title">Catálogo</div>
                                <div class="cd-sub">Pulsa “Añadir” para meter productos al carrito</div>
                            </div>

                            <div class="cd-search">
                                <i class="fa-solid fa-magnifying-glass"></i>
                                <input id="searchInput" type="text" placeholder="Buscar producto...">
                            </div>
                        </div>

                        <div id="catalogGrid" class="cd-grid"></div>

                        <div class="text-muted small mt-3">
                            *Los productos se leen de <b>lama_products</b> (inventario). Si está vacío, se hace seed
                            automático con tus ejemplos.
                        </div>
                    </div>
                </div>

                <!-- resume -->
                <div class="col-lg-4">
                    <div class="cd-summary">
                        <div class="cd-summary-head">
                            <div>
                                <div class="cd-title">Resumen del pedido</div>
                                <div class="cd-sub">Cliente: <span id="clientLabel">—</span></div>
                            </div>

                            <button class="cd-link" id="btnClearCart" type="button">
                                <i class="fa-solid fa-trash-can"></i> Vaciar
                            </button>
                        </div>

                        <div id="cartEmpty" class="cd-empty">
                            <i class="fa-solid fa-basket-shopping"></i>
                            <div class="mt-2 fw-bold">Tu carrito está vacío</div>
                            <div class="text-muted small">Añade productos desde el catálogo</div>
                        </div>

                        <div id="cartWrap" class="d-none">
                            <ul id="cartList" class="cd-cart"></ul>

                            <div class="cd-total">
                                <div class="text-muted">Total</div>
                                <div class="cd-total-val" id="totalPrice">0,00 €</div>
                            </div>

                            <hr class="my-3">

                            <label class="form-label fw-semibold">Fecha de recogida</label>
                            <input id="pickupDate" type="date" class="form-control">
                            <div id="dateHelp" class="small text-muted mt-1">
                                Debe ser mínimo dentro de <b>2 días</b>.
                            </div>
                            <div id="dateError" class="small text-danger mt-1 d-none"></div>

                            <div class="mt-3">
                                <label class="form-label fw-semibold">Notas (opcional)</label>
                                <textarea id="orderNotes" class="form-control" rows="3"
                                    placeholder="Ej: sin azúcar, alergias, hora aproximada..."></textarea>
                            </div>

                            <button id="btnGeneratePdf" class="btn btn-custom w-100 py-3 fw-bold mt-3">
                                <i class="fa-solid fa-file-pdf me-2"></i>Emitir PDF (simulado)
                            </button>

                            <div class="text-muted small mt-2">
                                *Se guardará un pedido en <b>lama_orders</b> con estado <b>Pendiente</b>.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <footer class="footer pt-4 pb-2">
        <div class="container">
            <div class="row row-cols-1 row-cols-md-4 g-4 text-center text-md-start mb-2">
                <div class="col d-flex align-items-center justify-content-center justify-content-md-start gap-3">
                    <img src="/assests/logo_Pastelerialama.png" alt="Pastelería Lama" class="footer-logo">
                    <div class="footer-socials">
                        <a href="https://www.facebook.com/Lama-Pasteler%C3%ADa-panader%C3%ADa-y-bolleria-100054487568378/"
                            target="_blank"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://www.instagram.com/pastelerialama?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw=="
                            target="_blank"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
                <div class="col">
                    <h6 class="footer-title">CONTACTO</h6>
                    <p>926 89 67 74 | 660 87 84 19<br>info@pastelerialama.es</p>
                </div>
                <div class="col">
                    <h6 class="footer-title">UBICACIÓN</h6>
                    <p>Ctra. de Urda, 1<br>13670 Villarrubia (C. Real)</p>
                </div>
                <div class="col">
                    <h6 class="footer-title">HORARIO</h6>
                    <p>L-V: 10:00 - 20:00<br>S: 10:00 - 14:30</p>
                </div>
            </div>

            <hr class="footer-divider my-2">
            <div class="row align-items-center py-2">
                <div class="col-md-6 text-center text-md-start">
                    <div class="footer-links small mb-1">
                        <a href="/pages/aviso-legal.html">Aviso Legal</a> | <a href="/pages/cookies.html">Cookies</a> |
                        <a href="/pages/privacidad.html">Privacidad</a>
                    </div>
                    <p class="footer-copy small mb-0">© 2026 Pastelería Lama</p>
                </div>
                <div
                    class="col-md-6 d-flex justify-content-center justify-content-md-end gap-3 footer-kit mt-2 mt-md-0">
                    <img src="https://pastelerialama.es/wp-content/uploads/2025/03/logo-ue-inv-2.png" alt="UE">
                    <img src="https://pastelerialama.es/wp-content/uploads/2025/03/logo-mict-inv.png" alt="Gobierno">
                    <img src="https://pastelerialama.es/wp-content/uploads/2025/03/logo-ptr-inv.png" alt="PRTR">
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../auth-core.js"></script>

    <!-- Store compartido  -->
    <script src="/pages/trabajador/js/employee_store.js"></script>

    <script src="./js/client_dashboard.js"></script>
</body>

</html>